{"ast":null,"code":"import _objectSpread from\"/Users/andrewhigton/Documents/code/typescript/cineclub/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/andrewhigton/Documents/code/typescript/cineclub/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{connect}from'react-redux';import{Link}from'react-router-dom';import StripeCheckoutButton from'../../components/stripe-button/stripe-button';import'./checkoutfilm.css';;var CheckoutFilm=function CheckoutFilm(_ref){var films=_ref.films,history=_ref.history;var film=films.film;var _useState=useState({_id:film._id,user:film.user,title:film.title,date:film.date,filmtime:film.filmtime,cinema:film.cinema,image:film.image,ticketPrice:film.ticketPrice,crowdfundTarget:film.crowdfundTarget,totalsoFar:film.totalsoFar}),_useState2=_slicedToArray(_useState,2),filmData=_useState2[0],setFilmData=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),bookingCost=_useState4[0],setBookingCost=_useState4[1];var _useState5=useState({title:film.title,ticketPrice:film.ticketPrice,date:film.date,cinema:film.cinema,crowdfundTarget:film.crowdfundTarget,totalsoFar:film.totalsoFar,numberOfTickets:0,cost:0}),_useState6=_slicedToArray(_useState5,2),ticketData=_useState6[0],setTicketData=_useState6[1];var _onChange=function onChange(e){var ticketsTotal=parseInt(e.target.value);var bookingTotal=parseInt(film.ticketPrice)*parseInt(e.target.value);var totalTicketsBooked=film.totalsoFar+parseInt(e.target.value);setBookingCost(bookingTotal);setTotalSoFar(totalTicketsBooked);setTicketTotalSoFar(totalTicketsBooked,bookingTotal,ticketsTotal);};var setTotalSoFar=function setTotalSoFar(totalTicketsBooked){setFilmData(_objectSpread(_objectSpread({},filmData),{},{totalsoFar:totalTicketsBooked}));};var setTicketTotalSoFar=function setTicketTotalSoFar(totalTicketsBooked,bookingTotal,ticketsTotal){setTicketData(_objectSpread(_objectSpread({},ticketData),{},{totalsoFar:totalTicketsBooked,cost:bookingTotal,numberOfTickets:ticketsTotal}));};var moment=require('moment');var formatDate=moment(film.date);var formattedDate=formatDate.format('D MMMM YYYY');return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"checkout-page\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",null,\"Film: \",film.title)),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",null,\"Date: \",formattedDate,\" \")),/*#__PURE__*/React.createElement(\"div\",{className:\"header-block\"},/*#__PURE__*/React.createElement(\"span\",null,\"Price: \\xA3\",film.ticketPrice,\" \")),/*#__PURE__*/React.createElement(\"div\",{className:\"header-block\"},/*#__PURE__*/React.createElement(\"span\",null,\"Crowdfunding Target: \",film.crowdfundTarget,\" \")),/*#__PURE__*/React.createElement(\"div\",{className:\"header-block\"},/*#__PURE__*/React.createElement(\"span\",null,\"Tickets sold: \",film.totalsoFar)),/*#__PURE__*/React.createElement(\"form\",{className:\"checkout-form\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"input\",{className:\"checkout-tickets\",type:\"number\",min:\"0\",placeholder:\"Number of tickets\",name:\"tickets\",onChange:function onChange(e){return _onChange(e);},required:true}))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",null,\"Basket total: \\xA3\",isNaN(bookingCost)?0:bookingCost)),/*#__PURE__*/React.createElement(\"div\",{className:\"\"},/*#__PURE__*/React.createElement(\"span\",null,/*#__PURE__*/React.createElement(StripeCheckoutButton,{history:history,filmData:filmData,ticketData:ticketData,price:bookingCost}))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Link,{className:\"go-back btn btn-back\",to:\"/film/dashboard\"},\"Go Back\"))));};var mapStateToProps=function mapStateToProps(state){return{films:state.film};};export default connect(mapStateToProps)(CheckoutFilm);// const film = useSelector((state) => state.film.film)\n// const loading = useSelector((state) => state.film.loading)","map":{"version":3,"names":["React","useState","connect","Link","StripeCheckoutButton","CheckoutFilm","films","history","film","_id","user","title","date","filmtime","cinema","image","ticketPrice","crowdfundTarget","totalsoFar","filmData","setFilmData","bookingCost","setBookingCost","numberOfTickets","cost","ticketData","setTicketData","onChange","e","ticketsTotal","parseInt","target","value","bookingTotal","totalTicketsBooked","setTotalSoFar","setTicketTotalSoFar","moment","require","formatDate","formattedDate","format","isNaN","mapStateToProps","state"],"sources":["/Users/andrewhigton/Documents/code/typescript/cineclub/client/src/components/checkout-film/Checkout-Film.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { ticketType, filmInterface, filmType, ChildComponentProps } from '../../utils/componentTypes';\nimport StripeCheckoutButton from '../../components/stripe-button/stripe-button';\n\nimport './checkoutfilm.css'\n\ninterface CheckoutFilmProps {\n  films: filmInterface;\n  match:() => void;\n  location:() => void;\n  history: () => void;\n  };\n\ntype JointCheckoutFilmProps = ChildComponentProps & CheckoutFilmProps\n\nconst CheckoutFilm: React.FC<JointCheckoutFilmProps> = ({ \n    films,\n    history\n    }) => {   \n\n  const { film } = films;\n\n  const [filmData, setFilmData] = useState<filmType>({\n    _id: film._id,\n    user: film.user,\n    title: film.title,\n    date: film.date,\n    filmtime: film.filmtime,\n    cinema: film.cinema,\n    image: film.image,\n    ticketPrice: film.ticketPrice,\n    crowdfundTarget: film.crowdfundTarget,\n    totalsoFar: film.totalsoFar\n  });\n\n  let [bookingCost, setBookingCost] = useState<number>(0);\n\n  const [ticketData, setTicketData] = useState<ticketType>({\n    title: film.title,\n    ticketPrice: film.ticketPrice,\n    date: film.date,\n    cinema: film.cinema,\n    crowdfundTarget: film.crowdfundTarget,\n    totalsoFar: film.totalsoFar,\n    numberOfTickets: 0,\n    cost: 0\n  });\n    \n   \n    const onChange = (e) => {   \n    let ticketsTotal = parseInt(e.target.value);\n    let bookingTotal = parseInt(film.ticketPrice) * parseInt(e.target.value); \n    let totalTicketsBooked = film.totalsoFar + parseInt(e.target.value)\n    setBookingCost(bookingTotal)\n    setTotalSoFar(totalTicketsBooked);\n    setTicketTotalSoFar(totalTicketsBooked, bookingTotal, ticketsTotal);\n\n  }\n\n  const setTotalSoFar = (totalTicketsBooked) => {\n    setFilmData({...filmData, totalsoFar: totalTicketsBooked });\n  }\n\n  const setTicketTotalSoFar = (totalTicketsBooked, bookingTotal, ticketsTotal) => {\n    setTicketData({...ticketData, \n     totalsoFar: totalTicketsBooked, \n     cost: bookingTotal,\n     numberOfTickets: ticketsTotal });\n  } \n\n  const moment = require('moment');\n  const formatDate = moment(film.date)\n  const formattedDate = formatDate.format('D MMMM YYYY');\n \n  return (\n      <>\n      <div className='checkout-page'>\n          <div>\n            <span>Film: {film.title}</span>\n          </div>\n          <div>\n            <span>Date: {formattedDate} </span>\n          </div>\n          <div className='header-block'>\n            <span>Price: £{film.ticketPrice} </span>\n          </div>\n          <div className='header-block'>\n            <span>Crowdfunding Target: {film.crowdfundTarget} </span>\n          </div>\n          <div \n          className='header-block'>\n            <span>Tickets sold: {film.totalsoFar}</span>\n          </div>\n        \n        <form className=\"checkout-form\">\n          <div>   \n            <input\n              className='checkout-tickets'\n              type='number'\n              min='0'\n              placeholder='Number of tickets'\n              name='tickets'\n              onChange={e => onChange(e)}\n              required\n            />\n          </div>  \n        </form>\n          <div>\n            <span>Basket total: £{\n              isNaN(bookingCost) ? 0 \n              : bookingCost}\n            </span>\n          </div>\n          <div className=\"\">\n              <span> \n                <StripeCheckoutButton\n                  history={history}\n                  filmData={filmData}\n                  ticketData={ticketData}\n                  price={bookingCost}\n                 />\n              </span>\n          </div>\n          <div>\n            <Link className='go-back btn btn-back' to='/film/dashboard'>Go Back</Link>\n          </div>\n          </div>\n        </>\n  )\n}\n\nconst mapStateToProps = state => ({\n  films: state.film\n});\n\nexport default connect(mapStateToProps)(CheckoutFilm); \n\n// const film = useSelector((state) => state.film.film)\n// const loading = useSelector((state) => state.film.loading)\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}