{"ast":null,"code":"import _regeneratorRuntime from\"/Users/andrewhigton/Documents/code/typescript/cineclub/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/andrewhigton/Documents/code/typescript/cineclub/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';import{ActionType}from'./types';import setAuthToken from'../utils/setAuthToken';// Add Tickets\nexport var updateUserTickets=function updateUserTickets(formData,history){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;config={headers:{'Content-Type':'application/json'}};_context.next=4;return axios.post('/api/users/ticket',formData,config);case 4:res=_context.sent;dispatch({type:ActionType.UPDATE_USER,payload:res.data});history.push('/');_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);if(_context.t0){alert(_context.t0);dispatch({type:ActionType.LOGIN_FAIL,payload:null});}case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function(_x){return _ref.apply(this,arguments);};}();};// Load User\nexport var loadUser=function loadUser(){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(localStorage.token){setAuthToken(localStorage.token);}_context2.prev=1;_context2.next=4;return axios.get('/api/auth');case 4:res=_context2.sent;dispatch({type:ActionType.USER_LOADED,payload:res.data});_context2.next=12;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);alert('Please check your email and password');dispatch({type:ActionType.AUTH_ERROR,payload:null});case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};// Register User\nexport var register=function register(name,email,password){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({name:name,email:email,password:password});_context3.prev=2;_context3.next=5;return axios.post('/api/users',body,config);case 5:res=_context3.sent;dispatch({type:ActionType.REGISTER_SUCCESS,payload:res.data});dispatch(loadUser());_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](2);if(_context3.t0){alert(_context3.t0);dispatch({type:ActionType.REGISTER_FAIL,payload:null});}case 13:case\"end\":return _context3.stop();}}},_callee3,null,[[2,10]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};//Login User\nexport var login=function login(email,password){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({email:email,password:password});_context4.prev=2;_context4.next=5;return axios.post('/api/auth',body,config);case 5:res=_context4.sent;dispatch({type:ActionType.LOGIN_SUCCESS,payload:res.data});dispatch(loadUser());_context4.next=13;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](2);if(_context4.t0){alert(_context4.t0);dispatch({type:ActionType.LOGIN_FAIL,payload:null});}case 13:case\"end\":return _context4.stop();}}},_callee4,null,[[2,10]]);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var deleteTickets=function deleteTickets(id){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return axios.delete(\"/api/tickets/\".concat(id));case 3:res=_context5.sent;dispatch({type:ActionType.UPDATE_USER,payload:res.data});_context5.next=10;break;case 7:_context5.prev=7;_context5.t0=_context5[\"catch\"](0);if(_context5.t0){alert(_context5.t0);dispatch({type:ActionType.LOGIN_FAIL});}case 10:case\"end\":return _context5.stop();}}},_callee5,null,[[0,7]]);}));return function(_x5){return _ref5.apply(this,arguments);};}();};//Logout\nexport var logout=function logout(){return function(dispatch){dispatch({type:ActionType.LOGOUT});};};","map":{"version":3,"sources":["/Users/andrewhigton/Documents/code/typescript/cineclub/client/src/actions/auth.tsx"],"names":["axios","ActionType","setAuthToken","updateUserTickets","formData","history","dispatch","config","headers","post","res","type","UPDATE_USER","payload","data","push","alert","LOGIN_FAIL","loadUser","localStorage","token","get","USER_LOADED","AUTH_ERROR","register","name","email","password","body","JSON","stringify","REGISTER_SUCCESS","REGISTER_FAIL","login","LOGIN_SUCCESS","deleteTickets","id","delete","logout","LOGOUT"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport { ActionType } from './types';\nimport { ActionUser } from '../reducers/indexTypes';\nimport { Dispatch } from 'redux';\nimport { ticketType } from '../utils/componentTypes';\nimport setAuthToken from '../utils/setAuthToken';\n\n// Add Tickets\nexport const updateUserTickets = (formData: ticketType, history ) => async (dispatch: Dispatch<ActionUser>) => {\n  \n  try {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n\n    \n    const res = await axios.post('/api/users/ticket', formData, config);\n    \n    dispatch({\n      type: ActionType.UPDATE_USER,\n      payload: res.data\n    });\n    history.push('/');\n  } catch (err) {\n    if (err) {\n      alert(err)\n      dispatch({\n      type: ActionType.LOGIN_FAIL,\n      payload: null\n    });\n    }\n  }\n};\n\n\n\n// Load User\nexport const loadUser = () => async (dispatch: Dispatch<ActionUser>) => {\n  if (localStorage.token) {\n    setAuthToken(localStorage.token);\n  }\n  \n  \ntry {\n    const res = await axios.get('/api/auth');\n    dispatch({\n      type: ActionType.USER_LOADED,\n      payload: res.data\n    })\n\n} catch (err) {\n          alert('Please check your email and password')\n          dispatch({\n            type: ActionType.AUTH_ERROR,\n            payload: null\n        });\n      }\n  };\n\n\n// Register User\nexport const register = ( name: string, email: string, password: string ) => \n\nasync (dispatch: Dispatch<ActionUser>) => {    \n  \n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n  \n  const body = JSON.stringify({ name, email, password });\n\n    try {\n    const res = await axios.post('/api/users', body, config);\n  \n    dispatch({\n      type: ActionType.REGISTER_SUCCESS,\n      payload: res.data\n    });\n    dispatch<any>(loadUser());\n    \n\n    } catch (err) {\n    \n  \n    if (err) {\n      alert(err)\n      dispatch({\n      type: ActionType.REGISTER_FAIL,\n      payload: null\n    });\n    \n    }\n\n    \n  }\n};\n\n//Login User\nexport const login = (email: string | number, password: string | number) => async (dispatch: Dispatch<ActionUser>) => {\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n\n  const body = JSON.stringify({ email, password });\n\n  try {\n    const res = await axios.post('/api/auth', body, config);\n    dispatch({\n      type: ActionType.LOGIN_SUCCESS,\n      payload: res.data\n    })\n    dispatch<any>(loadUser());\n  } \n  catch (err) {\n    if (err) {\n      alert(err)\n      dispatch({\n      type: ActionType.LOGIN_FAIL,\n      payload: null\n    });\n    }\n\n  }\n};\n\n\nexport const deleteTickets = (id: string) => async dispatch => {\n  try {\n    const res = await axios.delete(`/api/tickets/${id}`);\n\n    dispatch({\n      type: ActionType.UPDATE_USER,\n      payload: res.data\n    });\n  } catch (err) {\n    if (err) {\n      alert(err)\n      dispatch({\n      type: ActionType.LOGIN_FAIL\n    });\n    }  \n  }\n};\n\n//Logout\nexport const logout = () => dispatch => {\n  dispatch({ type: ActionType.LOGOUT });\n};"]},"metadata":{},"sourceType":"module"}